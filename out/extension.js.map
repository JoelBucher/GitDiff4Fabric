{"version":3,"file":"extension.js","sourceRoot":"","sources":["../src/extension.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,4BAsDC;AAED,gCAA+B;AA3D/B,+CAAiC;AACjC,4DAA+B;AAE/B,SAAgB,QAAQ,CAAC,OAAgC;IACrD,MAAM,UAAU,GAAG,MAAM,CAAC,QAAQ,CAAC,eAAe,CAC9C,wBAAwB,EACxB,KAAK,IAAI,EAAE;QACP,IAAI,CAAC;YACD,gCAAgC;YAChC,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,cAAc,CAAC,UAAU,CAClD,WAAW,EACX,CAAC,mDAAmD,CAAC,EACrD,EAAE,YAAY,EAAE,IAAI,EAAE,CACzB,CAAC;YAEF,IAAI,CAAC,OAAO,EAAE,CAAC;gBACX,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC;gBAChD,OAAO;YACX,CAAC;YAED,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,CAAC;YAElC,qCAAqC;YACrC,MAAM,QAAQ,GAAG,MAAM,IAAA,oBAAK,EACxB,2CAA2C,EAC3C;gBACI,OAAO,EAAE;oBACL,aAAa,EAAE,UAAU,KAAK,EAAE;iBACnC;aACJ,CACJ,CAAC;YAEF,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC;gBACf,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;gBACnC,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAC1B,cAAc,QAAQ,CAAC,MAAM,IAAI,IAAI,EAAE,CAC1C,CAAC;gBACF,OAAO;YACX,CAAC;YAED,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;YAEnC,sBAAsB;YACtB,MAAM,cAAc,GAAG,IAAI,CAAC,KAAK,EAAE,MAAM,IAAI,CAAC,CAAC;YAE/C,MAAM,CAAC,MAAM,CAAC,sBAAsB,CAChC,gBAAgB,OAAO,CAAC,OAAO,CAAC,KAAK,WAAW,cAAc,cAAc,CAC/E,CAAC;QACN,CAAC;QAAC,OAAO,GAAQ,EAAE,CAAC;YAChB,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAC1B,UAAU,GAAG,CAAC,OAAO,IAAI,GAAG,EAAE,CACjC,CAAC;QACN,CAAC;IACL,CAAC,CACJ,CAAC;IAEF,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AAC3C,CAAC;AAED,SAAgB,UAAU,KAAI,CAAC","sourcesContent":["import * as vscode from 'vscode';\nimport fetch from 'node-fetch';\n\nexport function activate(context: vscode.ExtensionContext) {\n    const disposable = vscode.commands.registerCommand(\n        'fabric-auth-demo.login',\n        async () => {\n            try {\n                // Step 1: Get Microsoft session\n                const session = await vscode.authentication.getSession(\n                    'microsoft',\n                    ['https://analysis.windows.net/powerbi/api/.default'],\n                    { createIfNone: true }\n                );\n\n                if (!session) {\n                    vscode.window.showErrorMessage('Login failed.');\n                    return;\n                }\n\n                const token = session.accessToken;\n\n                // Step 2: Call Fabric (Power BI) API\n                const response = await fetch(\n                    'https://api.powerbi.com/v1.0/myorg/groups',\n                    {\n                        headers: {\n                            Authorization: `Bearer ${token}`\n                        }\n                    }\n                );\n\n                if (!response.ok) {\n                    const text = await response.text();\n                    vscode.window.showErrorMessage(\n                        `API error: ${response.status} ${text}`\n                    );\n                    return;\n                }\n\n                const data = await response.json();\n\n                // Step 3: Show result\n                const workspaceCount = data.value?.length ?? 0;\n\n                vscode.window.showInformationMessage(\n                    `Logged in as ${session.account.label}. Found ${workspaceCount} workspaces.`\n                );\n            } catch (err: any) {\n                vscode.window.showErrorMessage(\n                    `Error: ${err.message || err}`\n                );\n            }\n        }\n    );\n\n    context.subscriptions.push(disposable);\n}\n\nexport function deactivate() {}\n"]}